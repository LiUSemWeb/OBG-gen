@prefix rr: <http://www.w3.org/ns/r2rml#>.
@prefix rml: <http://semweb.mmlab.be/ns/rml#>.
@prefix ql: <http://semweb.mmlab.be/ns/ql#>.
@prefix xsd: <http://www.w3.org/2001/XMLSchema#>.
@prefix schema: <http://schema.org/>.
@prefix wgs84_pos: <http://www.w3.org/2003/01/geo/wgs84_pos#lat>.
@prefix gn: <http://www.geonames.org/ontology#>.
@prefix core: <https://w3id.org/mdo/core/>.
@prefix structure: <https://w3id.org/mdo/structure/>.
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>.
@prefix calculation: <https://w3id.org/mdo/calculation/>.
@prefix prov: <http://www.w3.org/ns/prov#>.
@prefix provenance: <https://w3id.org/mdo/provenance/>.
@prefix emmo: <http://emmo.info/domains/emmo-material.owl#>.
@prefix CHEBI-atom: <http://purl.obolibrary.org/obo/CHEBI_33250>.
@prefix CHEBI-formula: <http://purl.obolibrary.org/obo/chebi/formula>.
@prefix QUDT-Unit: <http://qudt.org/vocab/unit/>.
@prefix QUDT: <http://qudt.org/schema/qudt#>.
@prefix hydra: <http://www.w3.org/ns/hydra/core#>.
@base <http://example.com/ns#>.


<Calculation_JSONSource_1>
    rml:source "https://huanyu-li.github.io/data/calculation1.json"; 
    rml:referenceFormulation ql:JSONPath;
    rml:iterator "$.Calculations[*]".

<Calculation_CSVSource_1>
    rml:source "https://huanyu-li.github.io/data/calculation1.csv"; 
    rml:referenceFormulation ql:CSV.

<Structure_JSONSource_1>
    rml:source "https://huanyu-li.github.io/data/structure1.json"; 
    rml:referenceFormulation ql:JSONPath;
    rml:iterator "$.Structures[*]".

<Structure_CSVSource_1>
    rml:source "https://huanyu-li.github.io/data/structure1.csv"; 
    rml:referenceFormulation ql:CSV.

<Composition_JSONSource_1>
    rml:source "https://huanyu-li.github.io/data/composition1.json"; 
    rml:referenceFormulation ql:JSONPath;
    rml:iterator "$.Compositions[*]".

<Composition_CSVSource_1>
    rml:source "https://huanyu-li.github.io/data/composition1.csv"; 
    rml:referenceFormulation ql:CSV.

<Composition_JSONSource_2>
    rml:source "https://huanyu-li.github.io/data/composition2.json"; 
    rml:referenceFormulation ql:JSONPath;
    rml:iterator "$.data.Compositions[*]".

<Composition_CSVSource_2>
    rml:source "https://huanyu-li.github.io/data/composition2.csv"; 
    rml:referenceFormulation ql:CSV.

<Calculation_Mapping_1>
  rml:logicalSource <Calculation_JSONSource_1>;
  rr:subjectMap [
    rr:template "http://example.com/{id}/Calculation";
    rr:class core:Calculation
  ];
  rr:predicateObjectMap [
    rr:predicate core:ID;
    rr:objectMap [
      rml:reference "id";
      rr:datatype xsd:string
    ];
  ];
  rr:predicateObjectMap [
    rr:predicate core:hasOutputStructure;
    rr:objectMap [
      rr:parentTriplesMap <Structure_Mapping_1>;
      rr:joinCondition [
        rr:child "output_sid";
        rr:parent "structure_id";
      ];
    ];
  ].


<Structure_Mapping_1>
    rml:logicalSource <Structure_JSONSource_1>;
    rr:subjectMap [
        rr:template "http://example.com/structure/{structure_id}";
        rr:class core:Structure
    ];
    rr:predicateObjectMap [
        rr:predicate structure:hasComposition;
        rr:objectMap[
            rr:parentTriplesMap <Composition_Mapping_1>;
            rr:joinCondition [
                rr:child "composition_id";
                rr:parent "composition_id";
            ];
        ];
    ];
    rr:predicateObjectMap [
        rr:predicate structure:hasComposition;
        rr:objectMap[
            rr:parentTriplesMap <Composition_Mapping_2>;
            rr:joinCondition [
                rr:child "composition_id";
                rr:parent "formula_id";
            ];
        ];
    ].


<Composition_Mapping_1>
    rml:logicalSource <Composition_JSONSource_1>;
    rr:subjectMap [
        rr:template "http://example.com/composition/{composition_id}";
        rr:class structure:Composition
    ];
    rr:predicateObjectMap [
        rr:predicate structure:ReducedFormula;
        rr:objectMap [
            rml:reference "Reduced_formula";
            rr:datatype xsd:string
        ]
    ];
    rr:predicateObjectMap [
        rr:predicate structure:AnonymousFormula;
        rr:objectMap [
            rml:reference "Composition_generic";
            rr:datatype xsd:string
        ];
    ].

<Composition_Mapping_2>
    rml:logicalSource <Composition_JSONSource_2>;
    rr:subjectMap [
        rr:template "http://example.com/composition/{formula_id}";
        rr:class structure:Composition
    ];
    rr:predicateObjectMap [
        rr:predicate structure:ReducedFormula;
        rr:objectMap [
            rml:reference "Reduced_formula";
            rr:datatype xsd:string
        ]
    ];
    rr:predicateObjectMap [
        rr:predicate structure:AnonymousFormula;
        rr:objectMap [
            rml:reference "Generic_formula";
            rr:datatype xsd:string
        ];
    ].
