@prefix rr: <http://www.w3.org/ns/r2rml#>.
@prefix rml: <http://semweb.mmlab.be/ns/rml#>.
@prefix ql: <http://semweb.mmlab.be/ns/ql#>.
@prefix xsd: <http://www.w3.org/2001/XMLSchema#>.
@prefix schema: <http://schema.org/>.
@prefix wgs84_pos: <http://www.w3.org/2003/01/geo/wgs84_pos#lat>.
@prefix gn: <http://www.geonames.org/ontology#>.
@prefix core: <https://w3id.org/mdo/core/>.
@prefix structure: <https://w3id.org/mdo/structure/>.
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>.
@prefix calculation: <https://w3id.org/mdo/calculation/>.
@prefix prov: <http://www.w3.org/ns/prov#>.
@prefix provenance: <https://w3id.org/mdo/provenance/>.
@prefix emmo: <http://emmo.info/domains/emmo-material.owl#>.
@prefix CHEBI-atom: <http://purl.obolibrary.org/obo/CHEBI_33250>.
@prefix CHEBI-formula: <http://purl.obolibrary.org/obo/chebi/formula>.
@prefix QUDT-Unit: <http://qudt.org/vocab/unit/>.
@prefix QUDT: <http://qudt.org/schema/qudt#>.
@prefix hydra: <http://www.w3.org/ns/hydra/core#>.
@prefix d2rq: <http://www.wiwiss.fu-berlin.de/suhl/bizer/D2RQ/0.1#>.
@prefix mydb: <http://www.myexample.com/mongodb#>.
@base <http://example.com/ns#>.

<DB_source_1>
    mydb:server "mongodb://127.0.0.1:27017/";
    mydb:username "user";
    mydb:password "password".

<Calculation_MongoDBSource_1>
    rml:source <DB_source_1>; 
    rml:referenceFormulation mydb:mongodb;
    rml:iterator "$.data[*]";
    rml:query "{'data.material_id':1};mp-16K;mp".

<Structure_MongoDBSource_1>
    rml:source <DB_source_1>; 
    rml:referenceFormulation mydb:mongodb;
    rml:iterator "$.data[*]";
    rml:query "{'data.material_id':1};mp-16K;mp".

<SpaceGroup_MongoDBSource_1>
    rml:source <DB_source_1>; 
    rml:referenceFormulation mydb:mongodb;
    rml:iterator "$.data[*]";
    rml:query "{'data.material_id':1, 'data.spacegroup':1};mp-16K;mp".

<Composition_MongoDBSource_1>
    rml:source <DB_source_1>; 
    rml:referenceFormulation mydb:mongodb;
    rml:iterator "$.data[*]";
    rml:query "{'data.material_id':1, 'data.formula_pretty':1};mp-16K;mp".

<Calculation_JSONSource_1>
    rml:source "https://huanyu-li.github.io/data/mp/mp-16K.json"; 
    rml:referenceFormulation ql:JSONPath;
    rml:iterator "$.data[*]".

<Calculation_Mapping_1>
  rml:logicalSource <Calculation_MongoDBSource_1>;
  rr:subjectMap [
    rr:template "http://example.com/calculation/{material_id}";
    rr:class core:Calculation
  ];
  rr:predicateObjectMap [
    rr:predicate core:ID;
    rr:objectMap [
      rml:reference "material_id";
      rr:datatype xsd:string
    ];
  ];
  rr:predicateObjectMap [
    rr:predicate core:hasOutputStructure;
    rr:objectMap [
      rr:parentTriplesMap <Structure_Mapping_1>;
      rr:joinCondition [
        rr:child "material_id";
        rr:parent "material_id";
      ];
    ];
  ].


<Structure_Mapping_1>
    rml:logicalSource <Structure_MongoDBSource_1>;
    rr:subjectMap [
        rr:template "http://example.com/structure/{material_id}";
        rr:class core:Structure
    ];
    rr:predicateObjectMap [
        rr:predicate structure:hasSpaceGroup;
        rr:objectMap[
            rr:parentTriplesMap <SpaceGroup_Mapping_1>;
            rr:joinCondition [
                rr:child "material_id";
                rr:parent "material_id";
            ];
        ];
    ];
    rr:predicateObjectMap [
        rr:predicate structure:hasComposition;
        rr:objectMap[
            rr:parentTriplesMap <Composition_Mapping_1>;
            rr:joinCondition [
                rr:child "material_id";
                rr:parent "material_id";
            ];
        ];
    ].


<SpaceGroup_Mapping_1>
    rml:logicalSource <SpaceGroup_MongoDBSource_1>;
    rr:subjectMap [
        rr:template "http://example.com/SpaceGroup/{material_id}";
        rr:class structure:SpaceGroup
    ];
    rr:predicateObjectMap [
        rr:predicate structure:SpaceGroupID;
        rr:objectMap [
            rml:reference "spacegroup.number";
            rr:datatype xsd:string
        ]
    ];
    rr:predicateObjectMap [
        rr:predicate structure:SpaceGroupSymbol;
        rr:objectMap [
            rml:reference "spacegroup.symbol";
            rr:datatype xsd:string
        ]
    ]
    .

<Composition_Mapping_1>
    rml:logicalSource <Composition_MongoDBSource_1>;
    rr:subjectMap [
        rr:template "http://example.com/composition/{material_id}";
        rr:class structure:Composition
    ];
    rr:predicateObjectMap [
        rr:predicate structure:ReducedFormula;
        rr:objectMap [
            rml:reference "formula_pretty";
            rr:datatype xsd:string
        ]
    ].